lcsm.py: could be optimized with DP approach
